\section{Errori delle classi}

Lo step successivo è stato quello di analizzare gli errori di predizione delle classi per ogni dataset.
Si è deciso di procedere per ogni dataset con il modello del RandomForestRegressor in quanto risulta essere il migliore in ogni caso.
Per quanto riguarda lo splitting dei dati, si è deciso di utilizzare uno split 70-30, ovvero il 70\% dei dati per il training e il 30\% per il testing, questo per avere delle misurazioni "confrontabili".
Il dataset è stato diviso in 3 classi, ovvero \textbf{low}, \textbf{medium} e \textbf{high}, in base ai valori di emissioni di CO2 (rispettivamente codificate con 0,1,2).
Per ogni elemento del test set, sono stati calcolati gli errori e successivamente si è proceduto a calcolare la media degli errori per ogni classe.
Gli errori sono stati calcolati come segue:
\begin{itemize}
    \item \textbf{Errore assoluto}:\begin{equation*}
        |y - \hat{y}|
         \end{equation*}
    \item \textbf{Errore percentuale}: \begin{equation*}
        \frac{|y - \hat{y}|}{y} \cdot 100
    \end{equation*}
\end{itemize}
dove $y$ è il valore reale e $\hat{y}$ è il valore predetto.


\subsection{Dataset Completo}

Il dataset completo conta 265 righe, di cui 185 per il training e 80 per il testing.
Il calcolo delle classi vede come \textbf{low\_bound} delle emissioni 0.36027045739563296 mentre l' \textbf{high\_bound} è 0.7205403996360675.
Nella totalità abbiamo 262 righe nella classe \textbf{low}, 1 nella classe \textbf{medium} e 2 nella classe \textbf{high}.


\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Classe} &  \textbf{Numero elementi} & \textbf{Errore assoluto medio} & \textbf{Errore percentuale medio} \\ \hline
        low             & 78                & 0.021805                   & 813            \\ \hline
        medium          & 0                & -                  & -            \\ \hline
        high            & 2                & 0.790026                   & 80            \\ \hline
    \end{tabular}
    \caption{Errori delle classi per il dataset completo}
\end{table}

\subsection{Dataset Completo Ridotto}

Il dataset completo "ridotto" conta 254 righe, di cui 177 per il training e 77 per il testing.
Il calcolo delle classi vede come \textbf{low\_bound} delle emissioni 0.029759662206275274 mentre l' \textbf{high\_bound} è 0.059518809257352256.
Nella totalità abbiamo 228 righe nella classe \textbf{low}, 17 nella classe \textbf{medium} e 9 nella classe \textbf{high}.


\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Classe} &  \textbf{Numero elementi} & \textbf{Errore assoluto medio} & \textbf{Errore percentuale medio} \\ \hline
        low             & 69                & 0.004995                   & 1723.95            \\ \hline
        medium          & 7                & 0.021113                  & 51.97            \\ \hline
        high            & 1                & 0.025475                   & 41.23            \\ \hline
    \end{tabular}
    \caption{Errori delle classi per il dataset completo ridotto}
\end{table}


\subsection{Dataset Azure}

Il dataset Azure conta 91 righe, di cui 63 per il training e 28 per il testing.
Il calcolo delle classi vede come \textbf{low\_bound} delle emissioni 0.3610033427811713 mentre l' \textbf{high\_bound} è 0.7203571782896829.
Nella totalità abbiamo 88 righe nella classe \textbf{low}, 1 nella classe \textbf{medium} e 2 nella classe \textbf{high}.


\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Classe} &  \textbf{Numero elementi} & \textbf{Errore assoluto medio} & \textbf{Errore percentuale medio} \\ \hline
        low             & 78                & 0.044774                   & 188.63            \\ \hline
        medium          & 0                & -                  & -            \\ \hline
        high            & 2                & 0.588654                   & 66.76            \\ \hline
    \end{tabular}
    \caption{Errori delle classi per il dataset Azure}
\end{table}

\subsection{Dataset Azure Ridotto}

Il dataset Azure "ridotto" conta 83 righe, di cui 58 per il training e 25 per il testing.
Il calcolo delle classi vede come \textbf{low\_bound} delle emissioni 0.021137526211647432 mentre l' \textbf{high\_bound} è 0.04062554515063527.
Nella totalità abbiamo 64 righe nella classe \textbf{low}, 13 nella classe \textbf{medium} e 6 nella classe \textbf{high}.


\begin{table}[H]
    \centering
    \begin{tabular}{|c|c|c|c|}
        \hline
        \textbf{Classe} &  \textbf{Numero elementi} & \textbf{Errore assoluto medio} & \textbf{Errore percentuale medio} \\ \hline
        low             & 20                & 0.005607                   & 103.15            \\ \hline
        medium          & 5                & 0.017295                  & 61.7            \\ \hline
        high            & 0                & -                   & -            \\ \hline
    \end{tabular}
    \caption{Errori delle classi per il dataset Azure ridotto}
\end{table}








